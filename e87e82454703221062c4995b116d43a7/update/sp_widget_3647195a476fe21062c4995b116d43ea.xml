<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function skill ($scope, $http, spUtil) {
  var c = this;
  c.skills = [];

  // Carregar as skills do usuário logado
  c.getSkills = function() {
    $http.get('/api/now/table/x_967632_mock_skil_skill?sysparm_query=colaborador=' + c.data.userId)
      .then(function(response) {
        c.skills = response.data.result;
      });
  };

  // Adicionar nova skill
  c.addSkill = function() {
    var nova = {
      colaborador: c.data.userId,
      skill: "Nova Skill",
      tipo: "Automático",
      nivel: "Iniciante"
    };
    $http.post('/api/now/table/x_967632_mock_skil_skill', nova).then(function() {
      c.getSkills();
    });
  };

  // Atualizar skill
  c.updateSkill = function(s) {
    $http.patch('/api/now/table/x_967632_mock_skil_skill/' + s.sys_id, {
      nivel: s.nivel
    });
  };

  // Deletar skill
  c.deleteSkill = function(s) {
    if (c.skills.length === 1) {
      spUtil.addErrorMessage("Você precisa ter pelo menos uma skill adicionada.");
      return;
    }
    $http.delete('/api/now/table/x_967632_mock_skil_skill/' + s.sys_id).then(function() {
      c.getSkills();
    });
  };

  c.getSkills();
}
]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id/>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {
  
}]]></link>
        <name>Skills</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  data.userId = gs.getUserID();
})();
]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-26 02:40:35</sys_created_on>
        <sys_id>3647195a476fe21062c4995b116d43ea</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>Skills</sys_name>
        <sys_package display_value="Mock SkillUp" source="x_967632_mock_skil">e87e82454703221062c4995b116d43a7</sys_package>
        <sys_policy/>
        <sys_scope display_value="Mock SkillUp">e87e82454703221062c4995b116d43a7</sys_scope>
        <sys_update_name>sp_widget_3647195a476fe21062c4995b116d43ea</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-26 02:41:31</sys_updated_on>
        <template><![CDATA[<div class="card p-3 shadow-sm">
  <h4 class="mb-3">Minhas Skills</h4>

  <!-- Botão adicionar -->
  <button class="btn btn-primary mb-3" ng-click="c.addSkill()">Adicionar Skill</button>

  <!-- Lista de skills -->
  <table class="table table-bordered">
    <thead class="table-dark">
      <tr>
        <th>Skill</th>
        <th>Tipo</th>
        <th>Nível</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="s in c.skills">
        <td>{{s.skill}}</td>
        <td>{{s.tipo}}</td>
        <td>
          <select class="form-select" ng-model="s.nivel" ng-change="c.updateSkill(s)">
            <option value="Iniciante">Iniciante</option>
            <option value="Intermediário">Intermediário</option>
            <option value="Avançado">Avançado</option>
            <option value="Expert">Expert</option>
          </select>
        </td>
        <td>
          <button class="btn btn-danger btn-sm" ng-click="c.deleteSkill(s)">Excluir</button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Mensagem caso não tenha skills -->
  <div ng-if="c.skills.length === 0" class="alert alert-warning mt-3">
    Você precisa ter pelo menos uma skill adicionada.
  </div>
</div>
]]></template>
    </sp_widget>
</record_update>
