<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_transform_script">
    <sys_transform_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <map display_value="Importacao de bug">bd84162c475b625062c4995b116d4322</map>
        <order>100</order>
        <script><![CDATA[(function transformRow(source, target, map, log, action) {
    // Exemplo: source.projeto e source.tarefa são colunas do Excel
    var projetoNome = source.projeto + '';
    var tarefaNome = source.tarefa + '';
    
    // Verifica se o projeto existe
    var projetoGR = new GlideRecord('x_967632_mock_skil_projeto');
    projetoGR.addQuery('nome', projetoNome);
    projetoGR.query();
    
    if (projetoGR.next()) {
        // Verifica se a tarefa pertence ao projeto
        var tarefaGR = new GlideRecord('x_967632_mock_skil_tarefa_do_projeto');
        tarefaGR.addQuery('nome', tarefaNome);
        tarefaGR.addQuery('projeto', projetoGR.sys_id);
        tarefaGR.query();
        
        if (!tarefaGR.next()) {
            // Tarefa não pertence ao projeto
            log.info('Linha com erro: Tarefa "' + tarefaNome + '" não pertence ao projeto "' + projetoNome + '"');
            action.setAbortAction(true); // ignora esta linha
        }
    } else {
        // Projeto não existe
        log.info('Linha com erro: Projeto "' + projetoNome + '" não encontrado');
        action.setAbortAction(true); // ignora esta linha
    }
})(source, target, map, log, action);]]></script>
        <sys_class_name>sys_transform_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-08-08 10:28:06</sys_created_on>
        <sys_id>3f959e6c475b625062c4995b116d43d4</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>onBefore</sys_name>
        <sys_package display_value="Mock SkillUp" source="x_967632_mock_skil">e87e82454703221062c4995b116d43a7</sys_package>
        <sys_policy/>
        <sys_scope display_value="Mock SkillUp">e87e82454703221062c4995b116d43a7</sys_scope>
        <sys_update_name>sys_transform_script_3f959e6c475b625062c4995b116d43d4</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-08-08 10:29:00</sys_updated_on>
        <when>onBefore</when>
    </sys_transform_script>
</record_update>
